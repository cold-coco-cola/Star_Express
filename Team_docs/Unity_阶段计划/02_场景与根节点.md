# Unity 阶段计划 — 02：场景与根节点

> 依据 [技术文档_星穹铁道_Unity.md](../技术文档_星穹铁道_Unity.md) §3、§10.1 编写。  
> **目的**：在 `_Project/Scenes` 中建立关卡场景骨架、根节点层级、相机与坐标系，供后续 Prefab 与脚本挂载。  
> **依赖**：完成 [01_资源管理与文件布局](./01_资源管理与文件布局.md)，确保 `_Project/Scenes` 已存在。  
> **索引**：[00_索引与文件管理](./00_索引与文件管理.md)。

---

## 1. 目标（做出什么样）

- 在 **`Assets/Game/场景/`** 下有一个主关卡场景（如 **SolarSystem_01**），作为首版可玩关卡。
- 场景 Hierarchy 具备技术文档 §3.1 规定的**根节点**，便于后续挂 GameManager、LevelLoader、LineManager 及动态生成 Station、Line、Ship、Passenger。
- 使用 **2D 正交相机**，坐标系与 PRD/技术文档一致（1 世界单位 = 1 Unity 单位；太阳系约 x:0~6, y:-1.5~1.6）。

---

## 2. 根节点清单（技术文档 §3.1）

| 节点名 | 说明 |
|--------|------|
| **GameManager** | 挂载 GameManager 脚本；子节点可挂周计时、资源计数、失败/得分逻辑 |
| **Map** | 地图容器；子节点为动态生成的 Station、Line 视觉 |
| **Stations** | 空节点，其子对象为运行时按 LevelConfig 生成的 Station 实例 |
| **Lines** | 空节点，其子对象为 Line 的视觉表示（LineRenderer 等） |
| **Ships** | 空节点，其子对象为运行时放置的 Ship 实例 |
| **Passengers** | 可选：若乘客为独立 GameObject，可统一放此节点下 |
| **Canvas / UI** | 所有 UI：资源栏、选色面板、结算界面、分数、倒计时等 |
| **EventSystem** | Unity 默认，用于 UI 与点击 |

---

## 3. 在 Unity 内的具体步骤与操作

### 步骤 1：新建场景并保存到 _Project/Scenes

1. **File → New Scene**（或 Ctrl+N），选择 **Basic 2D (Built-in)** 或 **2D** 模板（若无 2D 模板，选 Empty 再自行添加相机）。
2. **File → Save As**，路径选 **Assets/Game/场景/**，命名为 **SolarSystem_01**，保存。

**结果**：得到 `Assets/Game/场景/SolarSystem_01.unity`。

---

### 步骤 2：确认或创建 2D 正交相机

1. 在 Hierarchy 中选中 **Main Camera**（若为空场景则需先 **GameObject → Camera** 创建相机）。
2. 在 Inspector 中确认：
   - **Projection**：**Orthographic**（2D 正交）。
   - **Orthographic Size**：建议 **4~5**（可覆盖 PRD 太阳系约 7 站范围 x:0~6, y:-1.5~1.6）。
   - **Position**：如 (0, 0, -10)，保证 Z 在场景前方，便于 2D 显示。

**结果**：相机满足技术文档 §3.2、§10.1 的坐标系与视野约定。

---

### 步骤 3：创建根节点（空 GameObject）

在 Hierarchy 根下，依次创建空节点（**GameObject → Create Empty**），命名**必须与下表一致**：

| 顺序 | 节点名 |
|------|--------|
| 1 | GameManager |
| 2 | Map |
| 3 | Stations |
| 4 | Lines |
| 5 | Ships |
| 6 | Passengers |
| 7 | Canvas |
| 8 | EventSystem（若列表中没有，则 **GameObject → UI → Event System**） |

**建议**：将 **Stations、Lines、Ships、Passengers** 拖成 **Map** 的**子节点**，这样 Map 作为地图容器，层级更清晰（技术文档中 Map 为「子节点为动态生成的 Station、Line 视觉」的容器，把 Stations/Lines/Ships/Passengers 放在 Map 下符合语义）。若严格按文档「根节点」理解为同级，也可全部与 GameManager、Map、Canvas 同级；本阶段两种皆可，后续脚本只需能通过名称或 Transform 找到对应根即可。

**推荐层级**（Map 为容器）：

```
Scene Root
├── GameManager
├── Map
│   ├── Stations
│   ├── Lines
│   ├── Ships
│   └── Passengers
├── Canvas
└── EventSystem
```

---

### 步骤 4：Canvas 与 EventSystem

1. **Canvas**：若新建的是空场景，通过 **GameObject → UI → Canvas** 会同时创建 Canvas 和 EventSystem。将 Canvas 命名为 **Canvas**（或保留默认），确保 **Render Mode** 为 **Screen Space - Overlay**（或按 UI 文档要求设为其他）。若有 **Canvas Scaler**，可按项目需要设置 Scale With Screen Size 等。
2. **EventSystem**：若已存在则保留，确保场景中有且仅有一个 EventSystem。

---

### 步骤 5：保存场景

**File → Save**（Ctrl+S），确认场景已保存到 `Assets/Game/场景/SolarSystem_01.unity`。

---

## 4. 执行后自检清单

- [ ] 场景文件位于 **Assets/Game/场景/SolarSystem_01.unity**。
- [ ] Main Camera 为 **Orthographic**，Orthographic Size 约 4~5。
- [ ] 存在根级或 Map 下的 **GameManager、Map、Stations、Lines、Ships、Passengers、Canvas、EventSystem**（命名一致）。
- [ ] 后续脚本可预期：GameManager 挂在 GameManager 节点；LevelLoader 在 GameManager 或独立；Stations/Lines/Ships 下为运行时生成的实例；UI 挂在 Canvas 下。

---

## 5. 与后续阶段的衔接

- **Prefab**：[03_Prefab与组件](./03_Prefab与组件.md) 中的 Station、Ship、Passenger 等将实例化到 Stations、Ships、Passengers 下；Line 视觉生成在 Lines 下。
- **脚本**：GameManager、LevelLoader、LineManager 等挂到对应节点后，从 LevelConfig 读站点并在 Stations 下生成 Station；航线视觉在 Lines 下生成。

---

*文档结束。*
